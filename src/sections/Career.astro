---
import {getCollection} from "astro:content";
import TimelineItem from "@/components/timeline/TimelineItem.tsx";
import SectionLayout from "@/layouts/SectionLayout.astro";
import {getTimelineInfo} from "@/utils/collectionUtil.ts";
import type {Timeline} from "@/content.config.ts";
interface Props{
    title: string
    name: string
}
const locale = Astro.currentLocale!;
const [experience, education, courses] = await Promise.all([
    getCollection("experience", ({ id }) => id.startsWith(locale))
        .then(entries => entries.map(e => e.data as Timeline)),
    getCollection("education", ({ id }) => id.startsWith(locale))
        .then(entries => entries.map(e => e.data as Timeline)),
    getCollection("courses", ({ id }) => id.startsWith(locale))
        .then(entries => entries.map(e => e.data as Timeline))
]);
const items = await getTimelineInfo([...education, ...courses, ...experience])
const props = Astro.props;
---
<SectionLayout id="career" title={props.title} section={props.name} left={80} width={105}>
    <ul style="list-style: none; display: flex; flex-direction: column; height: fit-content; width: 100%;padding-left: 0">
        {items.map(item => (
            <TimelineItem client:only data={item} locale={locale} />
        ))}
    </ul>
</SectionLayout>